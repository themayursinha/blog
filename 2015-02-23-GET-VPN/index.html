<!DOCTYPE html>
<html lang="en">
  <!-- Beautiful Jekyll | MIT license | Copyright Dean Attali 2016 -->
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover">

  <title>GET VPN</title>

  <meta name="author" content="Mayur Sinha" />

  

  <link rel="alternate" type="application/rss+xml" title=" - Mayur" href="/feed.xml" />

  

  

  
<!-- Google Analytics -->
<script>
    (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-136557652-1', 'auto');
    ga('send', 'pageview');
</script>
<!-- End Google Analytics -->



  
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-social/5.1.1/bootstrap-social.min.css">
    
  

  
    
      <link rel="stylesheet" href="/css/bootstrap.min.css" />
    
      <link rel="stylesheet" href="/css/main.css" />
    
  

  
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
    
      <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
    
  

  

  

  

  <!-- Facebook OpenGraph tags -->
  

  
  <meta property="og:title" content="GET VPN" />
  

  
  <meta property="og:description" content="To provide a true full mesh or even dense partial mesh of connectivity, tunnel-based solutions require the provisioning of a complex connectivity mesh. Such a complex mesh not only has higher processor and memory requirements, but is difficult to provision, troubleshoot, and manage. Cisco‘s Group Encrypted Transport VPN (GETVPN) introduces...">
  

  <meta property="og:type" content="website" />

  
  <meta property="og:url" content="https://themayursinha.com/2015-02-23-GET-VPN/" />
  <link rel="canonical" href="https://themayursinha.com/2015-02-23-GET-VPN/" />
  

  
  <meta property="og:image" content="https://themayursinha.com/img/hacker.jpg" />
  

  <!-- Twitter summary cards -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <meta name="twitter:creator" content="@" />

  
  <meta name="twitter:title" content="GET VPN" />
  

  
  <meta name="twitter:description" content="To provide a true full mesh or even dense partial mesh of connectivity, tunnel-based solutions require the provisioning of a complex connectivity mesh. Such a complex mesh not only has higher processor and memory requirements, but is difficult to provision, troubleshoot, and manage. Cisco‘s Group Encrypted Transport VPN (GETVPN) introduces...">
  

  
  <meta name="twitter:image" content="https://themayursinha.com/img/hacker.jpg" />
  

  

  

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
</head>

  <body>

    

  
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
        <a class="navbar-brand" href="https://themayursinha.com"></a>
      
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
        
          
            
              <li>






<a href="https://themayursinha.com">Home</a>
</li>
            
          
            
          
            
          
            
          
        
          
            
          
            
              <li>






<a href="/projects">Projects</a>
</li>
            
          
            
          
            
          
        
          
            
          
            
          
            
              <li>






<a href="/blogs">Blogs</a>
</li>
            
          
            
          
        
          
            
          
            
          
            
          
            
              <li>






<a href="https://themayursinha.com/tags/">Tags</a>
</li>
            
          
        
      <!-- Search icon and dropdown -->
      <li class="navbar-search" style="position: relative;">
        <span id="search-toggle" style="padding: 10px 15px; font-size: 1.1em; display: inline-block; cursor: pointer; vertical-align: middle;">
          <i class="fa fa-search" style="font-size: 1.1em;"></i>
        </span>
      </li>
      <!-- Theme toggle button -->
      <li class="navbar-theme-toggle" style="position: relative;">
        <a href="#" id="theme-toggle" style="padding: 10px 15px;" title="Toggle dark/light mode">
          <i id="theme-toggle-icon" class="fa fa-moon"></i>
        </a>
      </li>
      </ul>
    </div>

	
	<div class="avatar-container">
	  <div class="avatar-img-border">
	    <a href="https://themayursinha.com">
	      <img class="avatar-img" src="/img/hacker.jpg" />
		</a>
	  </div>
	</div>
	

  </div>
</nav>

<!-- Search Modal Overlay -->
<div id="search-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(255,255,255,0.98); z-index:2000; align-items:center; justify-content:center;">
  <div style="max-width:600px; margin:60px auto; background:#fff; border-radius:16px; box-shadow:0 8px 32px rgba(0,0,0,0.18); padding:32px 24px 24px 24px; position:relative;">
    <button id="search-modal-close" style="position:absolute; top:16px; right:16px; background:none; border:none; font-size:1.5em; cursor:pointer;">&times;</button>
    <div style="display:flex; align-items:center; gap:8px; margin-bottom:16px;">
      <i class="fa fa-search" style="font-size:1.2em; color:#888;"></i>
      <input type="text" id="search-modal-input" placeholder="Type a command or search..." style="flex:1; font-size:1.2em; border:none; outline:none; background:transparent; padding:8px 0;">
      <span style="font-size:0.9em; color:#bbb; border:1px solid #eee; border-radius:6px; padding:2px 8px; margin-left:8px;">ESC</span>
    </div>
    <div id="search-modal-results" style="max-height:340px; overflow-y:auto;"></div>
  </div>
</div>

<!-- Fuse.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js"></script>
<script>
// Ensure theme is set as early as possible on page load
(function() {
  const saved = localStorage.getItem('theme');
  const dark = saved ? saved === 'dark' : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);
  if (dark) {
    document.body.classList.add('dark-theme');
  } else {
    document.body.classList.remove('dark-theme');
  }
})();

// Modal open/close logic
function updateSearchModalTheme() {
  const isDark = document.body.classList.contains('dark-theme');
  const modal = document.getElementById('search-modal');
  const modalInner = modal.querySelector('div');
  if (isDark) {
    modal.style.background = 'rgba(24,26,27,0.98)';
    if (modalInner) {
      modalInner.style.background = '#23272a';
      modalInner.style.color = '#e8e6e3';
    }
  } else {
    modal.style.background = 'rgba(255,255,255,0.98)';
    if (modalInner) {
      modalInner.style.background = '#fff';
      modalInner.style.color = '#222';
    }
  }
}
function openSearchModal() {
  document.getElementById('search-modal').style.display = 'flex';
  document.getElementById('search-modal-input').focus();
  renderAllPosts();
  updateSearchModalTheme();
}
function closeSearchModal() {
  document.getElementById('search-modal').style.display = 'none';
  document.getElementById('search-modal-input').value = '';
  document.getElementById('search-modal-results').innerHTML = '';
}
let fuse, data = [];
function renderAllPosts() {
  const resultsDiv = document.getElementById('search-modal-results');
  if (!data.length) {
    resultsDiv.innerHTML = '<div style="padding:16px; color:#888;">Loading...</div>';
    return;
  }
  resultsDiv.innerHTML = data.map(item => `
    <div style="padding:12px 0; border-bottom:1px solid #f0f0f0; cursor:pointer;" onclick="window.location='${item.url}'">
      <div style="font-size:0.95em; color:#888;">${item.date ? new Date(item.date).toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric' }) : ''}</div>
      <div style="font-size:1.1em; color:#1a2; font-weight:500;">${item.title}</div>
    </div>
  `).join('');
}
document.addEventListener('DOMContentLoaded', function() {
  document.getElementById('search-toggle').onclick = function(e) {
    e.preventDefault();
    openSearchModal();
  };
  document.getElementById('search-modal-close').onclick = closeSearchModal;
  document.getElementById('search-modal-input').addEventListener('keydown', function(e) {
    if (e.key === 'Escape') closeSearchModal();
  });
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && document.getElementById('search-modal').style.display === 'flex') closeSearchModal();
  });
  document.getElementById('search-modal').addEventListener('click', function(e) {
    if (e.target === this) closeSearchModal();
  });
  // Fuse.js search logic
  fetch('/search.json')
    .then(res => res.json())
    .then(json => {
      data = json;
      fuse = new Fuse(data, {
        keys: [
          { name: 'title', weight: 0.7 },
          { name: 'content', weight: 0.3 }
        ],
        includeScore: true,
        threshold: 0.2,
        minMatchCharLength: 3,
        ignoreLocation: true,
      });
    });
  document.getElementById('search-modal-input').addEventListener('input', function(e) {
    const query = e.target.value.trim();
    const resultsDiv = document.getElementById('search-modal-results');
    if (!query) {
      renderAllPosts();
      return;
    }
    const keyword = query.toLowerCase();
    let results = fuse.search(keyword);
    // Filter to only include posts where the keyword is actually present
    results = results.filter(result => {
      const { title, content } = result.item;
      return (
        (title && title.toLowerCase().includes(keyword)) ||
        (content && content.toLowerCase().includes(keyword))
      );
    });
    if (results.length === 0) {
      resultsDiv.innerHTML = '<div style="padding:16px; color:#888;">No results found</div>';
      return;
    }
    resultsDiv.innerHTML = results.map(r => `
      <div style="padding:12px 0; border-bottom:1px solid #f0f0f0; cursor:pointer;" onclick="window.location='${r.item.url}'">
        <div style="font-size:0.95em; color:#888;">${r.item.date ? new Date(r.item.date).toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric' }) : ''}</div>
        <div style="font-size:1.1em; color:#1a2; font-weight:500;">${r.item.title}</div>
      </div>
    `).join('');
  });
  // Update modal theme on theme toggle
  var toggleBtn = document.getElementById('theme-toggle');
  if (toggleBtn) {
    toggleBtn.addEventListener('click', function() {
      setTimeout(updateSearchModalTheme, 10);
    });
  }
});

// Theme toggle logic
function setTheme(dark) {
  document.body.classList.toggle('dark-theme', dark);
  var icon = document.getElementById('theme-toggle-icon');
  if (icon) icon.className = dark ? 'fa fa-sun' : 'fa fa-moon';
  localStorage.setItem('theme', dark ? 'dark' : 'light');
}
function getSystemPrefersDark() {
  return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
}
document.addEventListener('DOMContentLoaded', function() {
  // Initial theme
  const saved = localStorage.getItem('theme');
  const dark = saved ? saved === 'dark' : getSystemPrefersDark();
  setTheme(dark);
  var toggleBtn = document.getElementById('theme-toggle');
  if (toggleBtn) {
    toggleBtn.onclick = function(e) {
      e.preventDefault();
      setTheme(!document.body.classList.contains('dark-theme'));
    };
  }
});
</script>
<style>
:root {
  --bg: #fff;
  --text: #222;
  --link: #008AFF;
  --nav-bg: #f5f5f5;
  --nav-text: #404040;
  --footer-bg: #f5f5f5;
  --footer-text: #777;
  --border: #e0e0e0;
}
body.dark-theme {
  --bg: #181a1b;
  --text: #e8e6e3;
  --link: #4ea1ff;
  --nav-bg: #23272a;
  --nav-text: #e8e6e3;
  --footer-bg: #181a1b;
  --footer-text: #aaa;
  --border: #333;
}
footer, .footer, .footer-minimal, .site-footer, .beautiful-jekyll-footer, .footer-links, .copyright, .theme-by, footer div, footer ul, footer li, footer p {
  background: var(--footer-bg) !important;
  color: var(--footer-text) !important;
  border-radius: 0 !important;
  box-shadow: none !important;
  border: none !important;
}
body, .container, .container-fluid, .intro-header, .posts-list, .post-preview, .row {
  background: var(--bg) !important;
  color: var(--text) !important;
}
h2.post-title, h3.post-subtitle {
  color: var(--text) !important;
}
body.dark-theme h2.post-title, body.dark-theme h3.post-subtitle {
  color: #fff !important;
}
a, a:visited {
  color: var(--link);
}
a:hover {
  color: #ffb347;
}
.navbar, .navbar-custom, .navbar-default {
  background: var(--nav-bg) !important;
  color: var(--nav-text) !important;
}
.navbar a, .navbar-nav > li > a {
  color: var(--nav-text) !important;
}
#search-modal {
  background: rgba(24,26,27,0.98);
}
body.dark-theme #search-modal {
  background: rgba(24,26,27,0.98);
}
body.dark-theme #search-modal .fa-search,
body.dark-theme #search-modal input#search-modal-input,
body.dark-theme #search-modal-results {
  color: #e8e6e3;
}
body.dark-theme #search-modal input#search-modal-input {
  background: transparent;
}
body.dark-theme #search-modal-results div[style*='cursor:pointer']:hover {
  background: #23272a;
}
.navbar-theme-toggle {
  margin-left: 8px;
}
#theme-toggle {
  cursor: pointer;
}
#theme-toggle-icon {
  font-size: 1.3em;
  vertical-align: middle;
}
</style>


    <!-- TODO this file has become a mess, refactor it -->





<header class="header-section ">

<div class="intro-header no-img">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <h1>GET VPN</h1>
		  
		  
		  
		  <span class="post-meta">Posted on February 23, 2015</span>
		  
        </div>
      </div>
    </div>
  </div>
</div>
</header>





<div class="container">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

      

      <article role="main" class="blog-post">
        <p><img src="https://themayursinha.com/img/get-vpn.png" alt="get-vpn" /></p>

<p>To provide a true full mesh or even dense partial mesh of connectivity, tunnel-based solutions require the provisioning of a complex connectivity mesh. Such a complex mesh not only has higher processor and memory requirements, but is difficult to provision, troubleshoot, and manage.</p>

<p>Cisco‘s Group Encrypted Transport VPN (GETVPN) introduces the concept of a trusted group to eliminate point-to-point tunnels and their associated overlay routing. All group members (GMs) share a common security association (SA), also known as a group SA. This enables GMs to decrypt traffic that was encrypted by any other GM. (Note that IPsec CE acts as a GM.) In GETVPN networks, there is no need to negotiate point-to- point IPsec tunnels between the members of a group, because GETVPN is tunnel-less. The IETF standard RFC-3547 Group Domain of Interpretation (GDOI) is an integral part of GETVPN. The GDOI protocol was introduced in 12.4(2)T but the GET VPN solution with several enhancements was released in 12.4(11)T.</p>

<p>Following are some of the advantages of GETVPN over other VPN technologies:</p>
<ul>
  <li>Provides highly scalable any to any mesh topology natively and eliminates the need for complex peer-to-peer security associations.</li>
  <li>For Multiprotocol Label Switching (MPLS) networks, maintains network intelligence (such as full-mesh connectivity, natural routing path, and QoS). Grants easy membership control with centralized key servers.</li>
  <li>Helps ensure low latency and jitter by enabling full-time, direct communications between sites, without requiring transport through a central hub.</li>
  <li>GETVPN allows replication of the packets after encryption. This allows the multicast traffic to be replicated at the core, thereby reducing the load and band width requirement on the Customer Premises Equipment (CPE).</li>
  <li>IP Address Preservation enables encrypted packets carry the original source and destination IP addresses in the outer IP header rather than replacing them with tunnel endpoint addresses. This technique is known as IPSec Tunnel Mode with Address Preservation. Some of the IP header parameters are also preserved. Many network features like routing, basic firewall, QoS, traffic management etc. work based on the information contained in the IP header. Since the IP header is persevered, all the network features will work as before. This eliminates lot of issues associated with deploying point to point encryption in a core network</li>
</ul>

<h2 id="group-encrypted-transport">GROUP ENCRYPTED TRANSPORT</h2>

<p><img src="https://themayursinha.com/img/get-vpn-a.png" alt="get-vpn-a" />
<img src="https://themayursinha.com/img/get-vpn-b.png" alt="get-vpn-b" /></p>

<p>GET VPN:</p>
<ul>
  <li>Suitable only in PRIVATE network, because it preserves original header</li>
  <li>QOS is possible because GETVPN preserves original header</li>
  <li>It eliminates POINT-TO-POINT VPN (site-site), overlay vpn (DMVPN)</li>
</ul>

<p><img src="https://themayursinha.com/img/get-vpn-c.png" alt="get-vpn-c" /></p>

<h3 id="centralized-location-for-interesting-traffic">Centralized location for interesting traffic</h3>
<p>Cisco‘s Group Encrypted Transport VPN (GET VPN) introduces the concept of a trusted group to eliminate point-to-point tunnels and their associated overlay routing. All group members (GMs) share a common security association (SA), also known as a group SA. This enables GMs to decrypt traffic that was encrypted by any other GM. (Note that IPsec CE acts as a GM.) In GET VPN networks, there is no need to negotiate point-to- point IPsec tunnels between the members of a group, because GET VPN is ―tunnel-less.
● GDOI (RFC 3547)
● Key servers (KSs)
● GMs
● IP tunnel header preservation
● Group security association
● Rekey mechanism
● Time-based anti-replay (TBAR)</p>

<p>The GDOI group key management protocol is used to provide a set of cryptographic keys and policies to a group of devices. In a GET VPN network, GDOI is used to distribute common IPsec keys to a group of enterprise VPN gateways that must communicate securely. These keys are periodically refreshed and are updated on all the VPN gateways using a process called rekey. The GDOI protocol is protected by a Phase 1 Internet Key Exchange (IKE) SA. All participating VPN gateways must authenticate themselves to the device providing keys using IKE.
GDOI introduces two different encryption keys. One key secures the GET VPN control plane; the other key secures the data traffic. The key used to secure the control plane is commonly called the Key Encryption Key (KEK), and the key used to encrypt data traffic is known as Traffic Encryption Key (TEK).</p>

<h3 id="tunnel-header-preservation">Tunnel Header Preservation</h3>
<p>In traditional IPsec, tunnel endpoint addresses are used as new packet source and destination. The packet is then routed over the IP infrastructure, using the encrypting gateway source IP address and the decrypting gateway destination IP address. In the case of GET VPN, IPsec protected data packets encapsulate the original source and destination packet addresses of the host in the outer IP header to ―preserve the IP address. Used in wan, not suitable for internet.</p>

<h3 id="key-server-ks">Key Server (KS)</h3>
<p>A key server (KS) is an IOS device responsible for creating and maintaining the GET VPN control plane. All encryption policies, such as interesting traffic, encryption protocols, security association, rekey timers, and so on, are centrally defined on the KS and are pushed down to all GMs at registration time. GMs authenticate with the KS using IKE Phase 1 (pre-shared keys or PKI) and then download the encryption policies and keys required for GET VPN operation. The KS is also responsible for refreshing and distributing the keys. Unlike traditional IPsec, interesting traffic defined on the KS (using an access control list (ACL)) is downloaded to every GM, whether or not the GM owns that network.</p>

<h3 id="group-member-gm">Group Member (GM)</h3>
<p>A GM is an IOS router responsible for actual encryption and decryption i.e. a device responsible to handle GETVPN data plane. A GM is only configured with IKE phase 1 parameters and KS/Group information.</p>

<h3 id="group-sa">Group SA</h3>
<p>Unlike traditional IPsec encryption solutions, GET VPN uses the concept of group SA. All members in the GET VPN group can communicate with each other using a common encryption policy and a shared SA. With a common encryption policy and a shared SA, there is no need to negotiate IPsec between GMs; this reduces the resource load on the IPsec routers.
 <strong>Note:</strong> In a GET VPN group, up to 100 ACL permit entries can be used to define interesting traffic for encryption. Each permit entry results in a pair of IPsec SAs; the maximum number of IPsec SAs in a group cannot exceed 200.</p>

<h3 id="rekey-process">Rekey Process</h3>
<p>As mentioned above, the KS is not only responsible for creating the encryption policies and keys, but also for refreshing keys and distribute them to GMs. The process of sending out new keys when existing keys are about to expire, is known as the rekey process. GET VPN supports two types of rekey messages: unicast and multicast. If a GM does not receive rekey information from the KS (for example, the KS is down or network connectivity is broken), the GM tries to reregister to an ordered set of KSs 60 seconds before the existing IPsec SAs expire. If reregistration is successful, the GM receives new SAs as part of the reregistration process and traffic in the data plane flows without disruption. If reregistration is unsuccessful (the preferred KS is unavailable), the GM tries three more times, at 10-second intervals, to establish a connection with the KS.</p>

<h3 id="unicast-rekey">Unicast Rekey</h3>
<p>In the unicast rekey process, a KS generates a rekey message and sends multiple copies of the message, one copy to each GM. Upon receiving the rekey message, a GM sends an ACK message to the KS. This ACK mechanism not only ensures that the list of active GMs on the KS is current, but also ensures that the rekey message is sent only to active GMs. If a GM does not acknowledge three consecutive rekeys (retransmissions are considered part of the rekey), the KS removes the GM from its active GM database and stops sending rekey messages to that GM.</p>

<h3 id="multicast-rekey">Multicast Rekey</h3>
<p>In the multicast rekey process, a KS generates a rekey message and sends one copy of the message to a multicast group address that is predefined in the configuration. Each GM joins the multicast group at registration time, so each GM receives a copy of the rekey message. Unlike unicast rekey, multicast rekey does not have an ACK mechanism.</p>

<h3 id="time-based-anti-replay-tbar">Time Based Anti-Replay (TBAR)</h3>
<p>GET VPN uses time-based anti-replay (TBAR), which is based on a pseudo-time clock that is maintained on the KS. An advantage of using pseudotime for TBAR is that there is no need to synchronize time on all the GET VPN devices using NTP. The primary KS is responsible for establishing and maintaining the pseudo-time for a group. The primary KS must also keep pseudotime synchronized on all GMs via rekey updates. Every GM includes its pseudo-time as a time stamp in the data packets. A receiving VPN gateway then compares time stamp of the received packet with the GM reference pseudotime clock it maintains for the group. If the packet arrived too late, it is dropped.</p>

<h3 id="fail-close-mode">Fail-Close Mode</h3>
<p>Until a group member registers with a key server, traffic passing through the group member is not encrypted. This state is called “fail open.” To prevent unencrypted traffic from passing through a group member before that member is registered, you can configure the Fail-Close feature. If the feature is configured, an implicit “permit ip any any” policy is installed, and all unencrypted traffic passing through the group member is dropped (this state is called fail-close mode).</p>

<ul>
  <li>Group Encrypted Transport</li>
  <li>Cisco Proprietary</li>
  <li>Components:
    <ul>
      <li>GDOI (Group Domain of Interpretation) [RFC 3547]
        <ul>
          <li>It is a protocol used to share keys</li>
          <li>It runs on protocol UDP 848</li>
          <li>ISAKMP Phase 1 protects GDOI</li>
          <li>GDOI has 2 keys:
            <ul>
              <li>Key Encryption Key (KEK) [KS –&gt; GM]</li>
              <li>Traffic Encryption Key (TEK) [GM &lt;–&gt; GM]</li>
            </ul>
          </li>
        </ul>
      </li>
      <li>Key Servers (KS)
        <ul>
          <li>It generates Keys for encryption</li>
          <li>It is used for policy generation, which guides as to which traffic needs to be encrypted and what encryption algorithm to use</li>
        </ul>
      </li>
      <li>Group Member (GM)</li>
      <li>Rekeying
        <ul>
          <li>It is a process of retransmission of keys by Key Server</li>
          <li>There are 2 types:
            <ul>
              <li>Unicast: Where KS sends keys to GM and GM replies with ACK</li>
              <li>Multicast: Where KS sends keys to multicast address 239.0.0.0 and GMs registered to that address receives it. No ACK!</li>
            </ul>
          </li>
        </ul>
      </li>
      <li>Time based Anti Replay
        <ul>
          <li>It is a mechanism to prevent Replay attack</li>
          <li>It uses metadata to create a psuedo clock which times the time between transmission and reception.</li>
          <li>IPSec sequence number technique does not work because in GET VPN a group SA is formed and the communication happens with multiple GM’s and the sequence numbers will not be continuous</li>
        </ul>
      </li>
      <li>IP Header preservation makes a copy of the Tunnel IP header and uses it in the IP (Hence not suitable on the Internet, to be used only on WAN.</li>
    </ul>
  </li>
</ul>

<p><img src="https://themayursinha.com/img/get-vpn-d.png" alt="get-vpn-d" /></p>

<h2 id="task-configure-get-vpn-for-the-topology-given-below">TASK: Configure GET VPN for the topology given below</h2>

<p><img src="https://themayursinha.com/img/get-vpn-e.png" alt="get-vpn-e" /></p>

<ol>
  <li>Please do the initial configuration on the routers by assigning ip addresses as shown above</li>
  <li>Please define static routes on all the devices such that R3 and R4 should know the R1 ip address of 10.1.12.1 (Key Server) and should use R2 as the next hop to reach each other’s loopback address</li>
  <li>Please note: Due to the IP Address preservation property of GET VPN (as defined above), R2 needs to know routes to the loopbacks of R3 and R4</li>
</ol>

<h4 id="let-us-first-start-with-key-server-configuration">Let us first start with Key Server Configuration</h4>
<p>First let us generate an RSA 1024 length key</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">R1(config)# ip domain-name cisco.com
R1(config)# crypto key generate rsa modulus 1024 label GET_KEY</code></pre></figure>

<p>Now let us start configuration for Phase 1 - ISAKMP Policy</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">R1(config)# crypto isakmp policy 10
    R1(isakmp-policy)# authentication pre-share
R1(config)# crypto isakmp key 0 GET_R3 address 10.1.23.3
R1(config)# crypto isakmp key 0 GET_R4 address 10.1.24.4</code></pre></figure>

<p>Now let us configure the Phase 2 - IPSec Transformset and Profile</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">R1(config)# crypto ipsec transform-set TSET esp-3des esp-sha-hmac
R1(config)# crypto ipsec profile GET_PRO
    R1(ipsec-profile)# set transform-set TSET</code></pre></figure>

<p>Now it is time to configure the Key Server</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">R1(config)# crypto gdoi group GET_VPN
    R1(config-gdoi-group)# identity number 134
    R1(config-gdoi-group)# server local // At this point the GDOI will get enabled
        R1(gdoi-local-server)# rekey authentication mypubkey rsa GET_KEY
        R1(gdoi-local-server)# rekey retransmit 10 number 2
        R1(gdoi-local-server)# rekey transport unicast
        R1(gdoi-local-server)# authorization address ipv4 GM-LIST // A standard ACL with a list of Group Member's IP Address
        R1(gdoi-local-server)# address ipv4 10.1.12.1 // Key Server's IP Address
        R1(gdoi-local-server)# sa ipsec 1
            R1(gdoi-sa-ipsec)# profile GET_PRO
            R1(gdoi-sa-ipsec)# match address ipv4 LAN_LIST // The extended ACL controlling traffic (to be encrypted or not)
            R1(gdoi-sa-ipsec)# replay counter window-size 64
R1(config)# ip access-list standard GM_LIST
    R1(config-std-nacl)# permit 10.1.23.3
    R1(config-std-nacl)# permit 10.1.24.4
R1(config)# ip access-list extended LAN_LIST
    R1(config-ext-nacl)# deny udp any eq 848 any eq 848 // Telling the GM's not to encrypt traffic between GM and KS
    R1(config-ext-nacl)# permit ip 192.168.0.0 0.0.255.255 192.168.0.0 0.0.255.255 // The interesting traffic between loopbacks of GMs</code></pre></figure>

<h4 id="now-let-us-configure-the-group-member">Now let us configure the Group Member</h4>
<p>Please Note: The beauty of GET VPN is that the configuration on all the GMs are identical! The only change in configuration is for the peer password. In the following commands ‘Rx’ denotes both R3 and R4</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">Rx(config)# crypto isakmp policy 10
    Rx(isakmp-policy)# authentication pre-share
R3(config)# crypto isakmp key 0 GET_R3 address 10.1.12.1
OR
R4(config)# crypto isakmp key 0 GET_R4 address 10.1.12.1
Rx(config)# crypto gdoi group GET_VPN
    Rx(config-gdoi-group)# identity number 134
    Rx(config-gdoi-group)# server  address ipv4 10.1.12.1
Rx(config)# crypto map CMAP 10 gdoi
    Rx(config-crypto-map)# set group GET_VPN
Rx(config)# interface f0/0
    Rx(config-if)# crypto map CMAP // As soon as you apply the map to the interface, GDOI negotiation will happen with the KS as shown in syslog</code></pre></figure>


      </article>

      
        <div class="blog-tags">
          Tags:
          
          
            <a href="/tags#netsec">netsec</a>
          
          
        </div>
      

      <ul class="pager blog-pager">
        
        <li class="previous">
          <a href="/2014-12-23-CRL-vs-OCSP/" data-toggle="tooltip" data-placement="top" title="CRL vs OCSP">&larr; Previous Post</a>
        </li>
        
        
        <li class="next">
          <a href="/2018-03-15-exploit-mitigation-techniques/" data-toggle="tooltip" data-placement="top" title="Memory exploit mitigation techniques">Next Post &rarr;</a>
        </li>
        
      </ul>

      
        <!-- Comment section removed -->
      
    </div>
  </div>
</div>


    <footer class="beautiful-jekyll-footer">
  <div style="text-align:center;">
    <ul class="list-inline text-center footer-links"><li><a href="mailto:themayursinha@gmail.com" title="Email me"><span class="fa-stack fa-lg" aria-hidden="true">
              <i class="fa fa-circle fa-stack-2x"></i>
              <i class="fa fa-solid fa-envelope fa-stack-1x fa-inverse"></i>
            </span>
            <span class="sr-only">Email me</span>
          </a>
        </li><li><a href="https://github.com/themayursinha" title="GitHub"><span class="fa-stack fa-lg" aria-hidden="true">
              <i class="fa fa-circle fa-stack-2x"></i>
              <i class="fa fa-brands fa-github fa-stack-1x fa-inverse"></i>
            </span>
            <span class="sr-only">GitHub</span>
          </a>
        </li><li><a href="https://twitter.com/themayursinha" title="Twitter"><span class="fa-stack fa-lg" aria-hidden="true">
              <i class="fa fa-circle fa-stack-2x"></i>
              <i class="fa fa-brands fa-twitter fa-stack-1x fa-inverse"></i>
            </span>
            <span class="sr-only">Twitter</span>
          </a>
        </li><li><a href="https://goodreads.com/themayursinha" title="Goodreads"><span class="fa-stack fa-lg" aria-hidden="true">
              <i class="fa fa-circle fa-stack-2x"></i>
              <i class="fa fa-brands fa-goodreads-g fa-stack-1x fa-inverse"></i>
            </span>
            <span class="sr-only">Goodreads</span>
          </a>
        </li><li><a href="https://linkedin.com/in/mayursinha" title="LinkedIn"><span class="fa-stack fa-lg" aria-hidden="true">
              <i class="fa fa-circle fa-stack-2x"></i>
              <i class="fa fa-brands fa-linkedin fa-stack-1x fa-inverse"></i>
            </span>
            <span class="sr-only">LinkedIn</span>
          </a>
        </li></ul>
    <p class="copyright text-muted">
      Mayur Sinha
      &nbsp;&bull;&nbsp;
      2025

      

      
    </p>
  </div>
</footer>

  
    






  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
      <script>
      	if (typeof jQuery == 'undefined') {
      	  document.write('<script src="/js/jquery-3.7.0.min.js"></scr' + 'ipt>');
      	}
      </script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/js/bootstrap.min.js"></script>
    
  
    <!-- doing something a bit funky here because I want to be careful not to include JQuery twice! -->
    
	<script src="/js/main.js"></script>
    
  


  
  </body>
</html>